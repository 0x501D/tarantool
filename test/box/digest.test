# encoding: tarantool

exec admin "lua type(box.digest)"

exec admin "lua box.digest.md4_hex()"
exec admin "lua box.digest.md5_hex()"
exec admin "lua box.digest.sha_hex()"
exec admin "lua box.digest.sha1_hex()"
exec admin "lua box.digest.sha224_hex()"
exec admin "lua box.digest.sha256_hex()"
exec admin "lua box.digest.sha384_hex()"
exec admin "lua box.digest.sha512_hex()"

exec admin "lua string.len(box.digest.md4_hex())"
exec admin "lua string.len(box.digest.md5_hex())"
exec admin "lua string.len(box.digest.sha_hex())"
exec admin "lua string.len(box.digest.sha1_hex())"
exec admin "lua string.len(box.digest.sha224_hex())"
exec admin "lua string.len(box.digest.sha256_hex())"
exec admin "lua string.len(box.digest.sha384_hex())"
exec admin "lua string.len(box.digest.sha512_hex())"

exec admin "lua string.len(box.digest.md4())"
exec admin "lua string.len(box.digest.md5())"
exec admin "lua string.len(box.digest.sha())"
exec admin "lua string.len(box.digest.sha1())"
exec admin "lua string.len(box.digest.sha224())"
exec admin "lua string.len(box.digest.sha256())"
exec admin "lua string.len(box.digest.sha384())"
exec admin "lua string.len(box.digest.sha512())"

exec admin "lua box.digest.md5_hex(123)"
exec admin "lua box.digest.md5_hex('123')"
exec admin "lua box.digest.md5_hex(true)"
exec admin "lua box.digest.md5_hex('true')"
exec admin "lua box.digest.md5_hex(nil)"
exec admin "lua box.digest.md5_hex()"

exec admin "lua box.digest.crc32()"
exec admin "lua box.digest.crc32_update(4294967295, '')"

exec admin "lua box.digest.crc32('abc')"
exec admin "lua box.digest.crc32_update(4294967295, 'abc')"

exec admin "lua box.digest.crc32('abccde')"
exec admin "lua box.digest.crc32_update(box.digest.crc32('abc'), 'cde')"
exec admin "lua crc = box.digest.crc32.new()"
exec admin "lua crc:update('abc')"
exec admin "lua crc2 = crc:copy()"
exec admin "lua crc:update('cde')"
exec admin "lua crc:result() == box.digest.crc32('abccde')"
exec admin "lua crc2:update('def')"
exec admin "lua crc2:result() == box.digest.crc32('abcdef')"
exec admin "lua crc, crc2 = nil, nil"

exec admin "lua box.digest.guava('hello', 0)"
exec admin "lua box.digest.guava(1, 'nope_')"
exec admin "lua box.digest.guava(10863919174838991, 11)"
exec admin "lua box.digest.guava(2016238256797177309, 11)"
exec admin "lua box.digest.guava(1673758223894951030, 11)"

exec admin "lua box.digest.murmur('1234')"
exec admin "lua mur = box.digest.murmur.new{seed=13}"
exec admin "lua nulldigest = mur:result()"
exec admin "lua mur:update('1234')"
exec admin "lua mur:result()"
exec admin "lua mur_new = mur:copy()"
exec admin "lua mur_new:update('1234')"
exec admin "lua mur_new:result() ~= mur:result()"
exec admin "lua mur:clear()"
exec admin "lua nulldigest == mur:result()"
exec admin "lua mur = box.digest.murmur.new{seed=14}"
exec admin "lua mur:update('1234')"
exec admin "lua mur:result()"
exec admin "lua mur, mur_new, nulldigest = nil, nil, nil"
