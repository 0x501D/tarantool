# encoding: tarantool
#


# clean data and restart with appropriate config
server.stop()
server.deploy("box/tarantool_tree_pk.cfg")
server.start()


exec sql "insert into t0 values (1, 'tuple')"
exec admin "save snapshot"
exec sql "insert into t0 values (2, 'tuple 2')"
exec admin "save snapshot"

server.stop()
server.start()

exec sql "insert into t0 values (3, 'tuple 3')"
exec sql "select * from t0 where k0 = 1"
exec sql "select * from t0 where k0 = 2"
exec sql "select * from t0 where k0 = 3"

# Cleanup
exec sql "delete from t0 where k0 = 1"
exec sql "delete from t0 where k0 = 2"
exec sql "delete from t0 where k0 = 3"

# resore default suite config
server.stop()
server.deploy(self.suite_ini["config"])
server.start()
